<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <!--A new product Id must be generated for each release!-->
  <Product Id="6EB0C2CD-9653-4CF8-92F2-F6E96AFFEAC8" Name="Axis" Language="1033" Version="0.1.3.0" Manufacturer="Axis" UpgradeCode="C9308797-6B58-4087-A656-9C8471EE2F0B">
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of Axis is already installed." AllowSameVersionUpgrades="yes"/>
    <MediaTemplate EmbedCab="yes"/>

    <Feature Id="ProductFeature" Title="TrackerInstaller" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentGroupRef Id="OtherFolders" />
    </Feature>
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="AppDataFolder" Name="Roaming">
        <Directory Id="GRASSHOPPER" Name="Grasshopper">
          <Directory Id="GHLIBRARIES" Name="Libraries">
            <Directory Id="INSTALLFOLDER" Name="Axis" />
          </Directory>
        </Directory>
      </Directory>
    </Directory>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="OtherFolders">
      <Component Id="GHLIBRARIES" Directory="GHLIBRARIES" Guid="830D63FE-00A1-4FF4-9A43-FFADE23E8681">
        <RemoveFolder Id='GHLIBRARIES' On='uninstall' />
        <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]\GHLIB' Type='string' Value='' KeyPath='yes' />
      </Component>
      <Component Id="GHROOT" Directory="GRASSHOPPER" Guid="898C28F6-4517-4FBE-A99E-610B56D5AF91">
        <RemoveFolder Id='GRASSHOPPER' On='uninstall' />
        <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]\GHROOT' Type='string' Value='' KeyPath='yes' />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Id="INSTALLFOLDER" Guid="6A86D03C-EA7E-419C-A227-7B7E4CD3F691">
        <RemoveFolder Id='INSTALLFOLDER' On='uninstall' />
        <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Type='string' Value='' KeyPath='yes' />
      </Component>



      <Component Id="mainGHA" Guid="DCCE6D53-8E49-426A-8006-E72BE6EDBDA2">
        <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]\GHA' Type='string' Value='' KeyPath='yes' />

        <File Source="$(var.Axis.TargetDir)" Name="Axis.gha"/>
        <File Source="$(var.Axis.TargetDir)Axis.dll"/>
        <File Source="$(var.Axis.TargetDir)ABB.Robotics.Controllers.PC.dll"/>
        <File Source="$(var.Axis.TargetDir)EPPlus.dll"/>
        <File Source="$(var.Axis.TargetDir)MathNet.Numerics.dll"/>
        <File Source="$(var.Axis.TargetDir)MathNet.Spatial.dll"/>
        <File Source="$(var.Axis.TargetDir)RobotStudio.Services.RobApi.dll"/>
        <File Source="$(var.Axis.TargetDir)RobotStudio.Services.RobApi.Desktop.dll"/>

      </Component>

    </ComponentGroup>
  </Fragment>
</Wix>
